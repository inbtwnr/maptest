# MapLibre GL –í–µ–∫—Ç–æ—Ä–Ω—ñ –¢–∞–π–ª–∏ –≤ Leaflet

## üìã –û–≥–ª—è–¥

–î–æ–¥–∞–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –≤–µ–∫—Ç–æ—Ä–Ω–∏—Ö —Ç–∞–π–ª—ñ–≤ MapLibre GL —É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç LeafletMapBox. –¢–µ–ø–µ—Ä –∫–∞—Ä—Ç–∞ –º–æ–∂–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è —è–∫ —É —Ä–∞—Å—Ç—Ä–æ–≤–æ–º—É (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ OSM —Ç–∞–π–ª–∏), —Ç–∞–∫ —ñ —É –≤–µ–∫—Ç–æ—Ä–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ –∑ –∫–∞—Å—Ç–æ–º–Ω–∏–º–∏ —Å—Ç–∏–ª—è–º–∏.

## üéØ –û—Å–Ω–æ–≤–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ –≤–µ–∫—Ç–æ—Ä–Ω–∏—Ö —Ç–∞–π–ª—ñ–≤

- ‚úÖ **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: –í–µ–∫—Ç–æ—Ä–Ω—ñ —Ç–∞–π–ª–∏ —à–≤–∏–¥—à–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è
- ‚úÖ **–Ø–∫—ñ—Å—Ç—å**: –ß—ñ—Ç–∫–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞ –±—É–¥—å-—è–∫—ñ–π —Ä–æ–∑–¥—ñ–ª—å–Ω—ñ–π –∑–¥–∞—Ç–Ω–æ—Å—Ç—ñ (–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –±–µ–∑ –≤—Ç—Ä–∞—Ç–∏ —è–∫–æ—Å—Ç—ñ)
- ‚úÖ **–ö–∞—Å—Ç–æ–º—ñ–∑–∞—Ü—ñ—è**: –ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å—Ç–∏–ª—è–º–∏ —á–µ—Ä–µ–∑ JSON –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
- ‚úÖ **–†–æ–∑–º—ñ—Ä**: –ú–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä –¥–∞–Ω–∏—Ö –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —Ä–∞—Å—Ç—Ä–æ–≤–∏–º–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏
- ‚úÖ **–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏ –ø–æ–¥—ñ—ó –Ω–∞ –æ–∫—Ä–µ–º—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∫–∞—Ä—Ç–∏

## üõ†Ô∏è –¢–µ—Ö–Ω—ñ—á–Ω–∏–π —Å—Ç–µ–∫

- **Leaflet**: –û—Å–Ω–æ–≤–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è –∫–∞—Ä—Ç
- **MapLibre GL**: –†–µ–Ω–¥–µ—Ä—ñ–Ω–≥ –≤–µ–∫—Ç–æ—Ä–Ω–∏—Ö —Ç–∞–π–ª—ñ–≤
- **@maplibre/maplibre-gl-leaflet**: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è MapLibre –≤ Leaflet
- **OpenStreetMap**: –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –ø–∞–∫–µ—Ç–∏

```bash
npm install maplibre-gl @maplibre/maplibre-gl-leaflet
```

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
public/
  styles/
    osm-styles.json     # –°—Ç–∏–ª—ñ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ—ó –∫–∞—Ä—Ç–∏

src/
  components/
    LeafletMapBox.tsx   # –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –≤–µ–∫—Ç–æ—Ä–Ω–∏—Ö —Ç–∞–π–ª—ñ–≤
  app/
    leaflet/
      page.tsx          # –°—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ –ø—Ä–∏–∫–ª–∞–¥–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
```

## üé® –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å—Ç–∏–ª—ñ–≤ (osm-styles.json)

–§–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å MapLibre GL Style Specification:

- **version**: 8 (–≤–µ—Ä—Å—ñ—è —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó)
- **sources**: –î–∂–µ—Ä–µ–ª–∞ –≤–µ–∫—Ç–æ—Ä–Ω–∏—Ö —Ç–∞–π–ª—ñ–≤ (OpenMapTiles)
- **layers**: –®–∞—Ä–∏ –∫–∞—Ä—Ç–∏ (—Ñ–æ–Ω, –≤–æ–¥–∞, –ø–∞—Ä–∫–∏, –±—É–¥—ñ–≤–ª—ñ, –¥–æ—Ä–æ–≥–∏, –ø—ñ–¥–ø–∏—Å–∏)

### –ü—Ä–∏–∫–ª–∞–¥ —à–∞—Ä—É –≤–æ–¥–∏:

```json
{
  "id": "water",
  "type": "fill",
  "source": "osm",
  "source-layer": "water",
  "paint": {
    "fill-color": "#a8c9ff",
    "fill-outline-color": "#7fa8e5"
  }
}
```

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```tsx
import LeafletMapBox from "@/components/LeafletMapBox";

export default function Page() {
  return (
    <LeafletMapBox
      initialLng={22.3006}
      initialLat={48.6208}
      initialZoom={12}
      useVectorTiles={true} // –£–≤—ñ–º–∫–Ω—É—Ç–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ñ —Ç–∞–π–ª–∏
    />
  );
}
```

### –ü—Ä–æ–ø `useVectorTiles`

- `true` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ñ —Ç–∞–π–ª–∏ –∑ MapLibre GL
- `false` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º) - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–∞—Å—Ç—Ä–æ–≤—ñ —Ç–∞–π–ª–∏ OSM

### –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤ runtime

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–∞—î –≤–±—É–¥–æ–≤–∞–Ω—É –∫–Ω–æ–ø–∫—É "üó∫Ô∏è –í–µ–∫—Ç–æ—Ä / üñºÔ∏è –†–∞—Å—Ç—Ä" –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –º—ñ–∂ —Ä–µ–∂–∏–º–∞–º–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

## üéõÔ∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç MapLibreLayer

–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —è–∫–∏–π –¥–æ–¥–∞—î –≤–µ–∫—Ç–æ—Ä–Ω–∏–π —à–∞—Ä –¥–æ Leaflet –∫–∞—Ä—Ç–∏:

```tsx
const MapLibreLayer: React.FC<{ useVectorTiles: boolean }> = ({
  useVectorTiles,
}) => {
  const map = useMap();

  useEffect(() => {
    if (!useVectorTiles) return;

    const maplibreLayer = (L as any).maplibreGL({
      style: "/styles/osm-styles.json",
      attribution: "¬© OpenStreetMap contributors",
    });

    maplibreLayer.addTo(map);

    return () => {
      if (map.hasLayer(maplibreLayer)) {
        map.removeLayer(maplibreLayer);
      }
    };
  }, [map, useVectorTiles]);

  return null;
};
```

## üé® –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤

–î–ª—è –∑–º—ñ–Ω–∏ –≤–∏–≥–ª—è–¥—É –∫–∞—Ä—Ç–∏ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `/public/styles/osm-styles.json`:

### –ó–º—ñ–Ω–∞ –∫–æ–ª—å–æ—Ä—É –≤–æ–¥–∏:

```json
{
  "id": "water",
  "paint": {
    "fill-color": "#YOUR_COLOR"
  }
}
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —à–∞—Ä—É:

```json
{
  "id": "custom-layer",
  "type": "fill",
  "source": "osm",
  "source-layer": "landcover",
  "filter": ["==", "class", "forest"],
  "paint": {
    "fill-color": "#green"
  }
}
```

## üìä –î–æ—Å—Ç—É–ø–Ω—ñ —Ç–∏–ø–∏ —à–∞—Ä—ñ–≤

- `background` - —Ñ–æ–Ω–æ–≤–∏–π –∫–æ–ª—ñ—Ä
- `fill` - –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø–æ–ª—ñ–≥–æ–Ω—ñ–≤
- `line` - –ª—ñ–Ω—ñ—ó (–¥–æ—Ä–æ–≥–∏, –∫–æ—Ä–¥–æ–Ω–∏)
- `symbol` - —Ç–µ–∫—Å—Ç —Ç–∞ —ñ–∫–æ–Ω–∫–∏
- `raster` - —Ä–∞—Å—Ç—Ä–æ–≤—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
- `circle` - –∫–æ–ª–∞ (—Ç–æ—á–∫–∏ —ñ–Ω—Ç–µ—Ä–µ—Å—É)

## üîó –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- [MapLibre GL Style Specification](https://maplibre.org/maplibre-style-spec/)
- [OpenMapTiles Schema](https://openmaptiles.org/schema/)
- [Leaflet Documentation](https://leafletjs.com/)
- [MapLibre GL JS](https://maplibre.org/maplibre-gl-js-docs/)

## üêõ –í—ñ–¥–æ–º—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è

1. **TypeScript**: `maplibreGL` –Ω–µ –º–∞—î –æ—Ñ—ñ—Ü—ñ–π–Ω–∏—Ö —Ç–∏–ø—ñ–≤, —Ç–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `any`
2. **SSR**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ—Ç—Ä–µ–±—É—î `ssr: false` –≤ Next.js dynamic import
3. **–ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –ü—Ä–∏ –∑–º—ñ–Ω—ñ —Å—Ç–∏–ª—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–∞—Ä—Ç—É (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ü–µ —Ä–æ–±–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

- [ ] –î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏—Ö —Å—Ç–∏–ª—ñ–≤
- [ ] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤–∏–±–æ—Ä—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (localStorage)
- [ ] –î–æ–¥–∞—Ç–∏ 3D –±—É–¥—ñ–≤–ª—ñ (extrusion)
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Mapbox API –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π
- [ ] –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤
